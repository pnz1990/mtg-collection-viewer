<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0d0d0d">
  <title>Game Tracker - MTG Collection Viewer</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mana-font@latest/css/mana.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css">
  <link rel="stylesheet" href="css/game-tracker.css">
</head>
<body>
  <!-- Rotate Warning -->
  <div id="rotate-warning" class="rotate-warning">
    <svg viewBox="0 0 24 24" width="64" height="64"><path fill="currentColor" d="M7.5 21.5c-.83 0-1.5-.67-1.5-1.5V4c0-.83.67-1.5 1.5-1.5h9c.83 0 1.5.67 1.5 1.5v16c0 .83-.67 1.5-1.5 1.5h-9zM12 18c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/><path fill="currentColor" d="M16.48 2.52c3.27 1.55 5.61 4.72 5.97 8.48h1.5C23.44 4.84 18.29 0 12 0l-.66.03 3.81 3.81 1.33-1.32z"/></svg>
    <p>Please rotate your device to landscape mode</p>
  </div>

  <!-- Setup Screen -->
  <div id="setup-screen" class="setup-screen">
    <div class="setup-card">
      <h1>Game Setup</h1>
      
      <div class="setup-section">
        <label>Players</label>
        <div class="player-select" id="player-count">
          <button data-value="2" class="selected">
            <svg viewBox="0 0 100 100"><circle cx="50" cy="20" r="12"/><circle cx="50" cy="80" r="12"/></svg>
            <span>2</span>
          </button>
          <button data-value="3">
            <svg viewBox="0 0 100 100"><circle cx="50" cy="15" r="10"/><circle cx="20" cy="75" r="10"/><circle cx="80" cy="75" r="10"/></svg>
            <span>3</span>
          </button>
          <button data-value="4">
            <svg viewBox="0 0 100 100"><circle cx="20" cy="20" r="10"/><circle cx="80" cy="20" r="10"/><circle cx="20" cy="80" r="10"/><circle cx="80" cy="80" r="10"/></svg>
            <span>4</span>
          </button>
        </div>
      </div>

      <div class="setup-section">
        <label>Starting Life</label>
        <div class="life-select" id="starting-life">
          <button data-value="20">20</button>
          <button data-value="40" class="selected">40</button>
          <button data-value="30">30</button>
        </div>
      </div>

      <button id="start-game" class="start-btn">Start Game</button>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="game-screen hidden">
    <div id="players-container" class="players-container"></div>
    
    <div class="tools-bar">
      <div class="clocks">
        <div class="clock-item">
          <span class="clock-label">Game</span>
          <span id="game-clock" class="clock-time">0:00</span>
        </div>
        <div class="clock-item">
          <span class="clock-label">Turn</span>
          <span id="turn-clock" class="clock-time">0:00</span>
        </div>
      </div>
      <div id="turn-counter" class="turn-counter">Turn 0</div>
      <button id="btn-first" class="tool-btn" title="Who Goes First">
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/></svg>
      </button>
      <button id="btn-pass" class="tool-btn" title="Pass Turn">
        <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z" fill="currentColor"/></svg>
      </button>
      <button id="btn-log" class="tool-btn" title="Game Log">
        <svg viewBox="0 0 24 24"><path d="M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z" fill="currentColor"/></svg>
      </button>
      <button id="btn-dice" class="tool-btn" title="Roll Dice">
        <svg class="dice-icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="3" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="8" cy="8" r="1.5" fill="currentColor"/><circle cx="12" cy="12" r="1.5" fill="currentColor"/><circle cx="16" cy="16" r="1.5" fill="currentColor"/></svg>
      </button>
      <button id="btn-coin" class="tool-btn" title="Flip Coin">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/><text x="12" y="16" text-anchor="middle" font-size="10" fill="currentColor">$</text></svg>
      </button>
      <button id="btn-stack" class="tool-btn" title="Stack Tracker">
        <svg viewBox="0 0 24 24"><path d="M2 15.5v2h20v-2H2zm0-5v2h20v-2H2zm0-5v2h20v-2H2z" fill="currentColor"/><path d="M4 20h16v2H4z" fill="currentColor"/></svg>
      </button>
      <button id="btn-reset" class="tool-btn" title="Reset">
        <svg viewBox="0 0 24 24"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" fill="currentColor"/></svg>
      </button>
      <button id="btn-menu" class="tool-btn" title="Home">
        <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" fill="currentColor"/></svg>
      </button>
    </div>
  </div>

  <!-- Commander Search Modal -->
  <div id="search-modal" class="modal hidden">
    <div class="modal-content search-content">
      <div class="modal-header">
        <h2>Set Commander</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="commander-slots" class="commander-slots">
        <div class="commander-slot active" data-slot="0">
          <span class="slot-label">Commander 1</span>
          <span class="slot-name" id="slot-name-0">Not set</span>
        </div>
        <div class="commander-slot hidden" data-slot="1">
          <span class="slot-label">Partner</span>
          <span class="slot-name" id="slot-name-1">Not set</span>
        </div>
      </div>
      <div class="search-box">
        <input type="text" id="search-input" placeholder="Search commanders..." autocomplete="off">
      </div>
      <div id="search-results" class="search-results"></div>
      <div class="modal-actions">
        <label class="rotate-toggle"><input type="checkbox" id="rotate-player"> Rotate panel 180°</label>
        <button id="clear-commander" class="action-btn secondary">Clear Commander(s)</button>
      </div>
    </div>
  </div>

  <!-- Dice Modal -->
  <div id="dice-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Roll Dice</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="dice-type-select">
        <button class="dice-type-btn selected" data-sides="6">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <rect x="5" y="5" width="40" height="40" rx="4" fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="16" cy="16" r="3" fill="currentColor"/><circle cx="34" cy="16" r="3" fill="currentColor"/>
            <circle cx="16" cy="34" r="3" fill="currentColor"/><circle cx="34" cy="34" r="3" fill="currentColor"/>
            <circle cx="25" cy="25" r="3" fill="currentColor"/>
          </svg>
          <span>D6</span>
        </button>
        <button class="dice-type-btn" data-sides="12">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <polygon points="25,2 47,15 47,35 25,48 3,35 3,15" fill="none" stroke="currentColor" stroke-width="2"/>
            <line x1="25" y1="2" x2="25" y2="48" stroke="currentColor" stroke-width="1.5"/>
            <line x1="3" y1="15" x2="47" y2="35" stroke="currentColor" stroke-width="1.5"/>
            <line x1="47" y1="15" x2="3" y2="35" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>D12</span>
        </button>
        <button class="dice-type-btn" data-sides="20">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <polygon points="25,2 45,18 38,45 12,45 5,18" fill="none" stroke="currentColor" stroke-width="2"/>
            <line x1="25" y1="2" x2="12" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="25" y1="2" x2="38" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="5" y1="18" x2="38" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="45" y1="18" x2="12" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="25" cy="28" r="8" fill="none" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>D20</span>
        </button>
      </div>
      <div class="dice-count-select">
        <button id="dice-minus" class="count-btn">−</button>
        <span id="dice-num">1</span>
        <button id="dice-plus" class="count-btn">+</button>
      </div>
      <div id="dice-stage" class="dice-stage"></div>
      <button id="roll-dice" class="action-btn">Roll</button>
    </div>
  </div>

  <!-- Coin Modal -->
  <div id="coin-modal" class="modal hidden">
    <div class="modal-content coin-content">
      <div class="modal-header">
        <h2>Flip Coin</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="coin-stage">
        <div id="coin" class="coin-3d">
          <div class="coin-face heads"></div>
          <div class="coin-face tails"></div>
        </div>
      </div>
      <div id="coin-result" class="coin-result"></div>
      <button id="flip-coin" class="action-btn">Flip</button>
    </div>
  </div>

  <!-- Commander Damage Modal -->
  <div id="cmdr-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Commander Damage</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="cmdr-grid" class="cmdr-grid"></div>
    </div>
  </div>

  <!-- Counters Modal -->
  <div id="counters-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="counters-title">Counters</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="counters-grid" class="counters-grid"></div>
    </div>
  </div>

  <!-- Mana Modal (mobile) -->
  <div id="mana-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="mana-title">Mana</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="mana-grid" class="mana-grid"></div>
    </div>
  </div>

  <!-- Game Log Modal -->
  <div id="log-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Game Log</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="log-list" class="log-list"></div>
    </div>
  </div>

  <!-- Stack Tracker Modal -->
  <div id="stack-modal" class="modal hidden">
    <div class="modal-content stack-content">
      <div class="modal-header">
        <h2>Stack Tracker</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="stack-search-box">
        <input type="text" id="stack-search-input" placeholder="Search for a card..." autocomplete="off">
      </div>
      <div id="stack-search-results" class="stack-search-results"></div>
      <div id="stack-player-selector" class="stack-player-selector hidden"></div>
      <div class="stack-label">Stack (top to bottom)</div>
      <div id="stack-container" class="stack-container"></div>
    </div>
  </div>


  <script src="js/game-tracker.js"></script>
</body>
</html>
