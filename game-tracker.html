<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0d0d0d">
  <title>Game Tracker - MTG Collection Viewer</title>
  <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="images/icon-192.png">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mana-font@latest/css/mana.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css">
  <link rel="stylesheet" href="css/game-tracker.css">
</head>
<body>
  <!-- Rotate Warning -->
  <div id="rotate-warning" class="rotate-warning">
    <svg viewBox="0 0 24 24" width="64" height="64"><path fill="currentColor" d="M7.5 21.5c-.83 0-1.5-.67-1.5-1.5V4c0-.83.67-1.5 1.5-1.5h9c.83 0 1.5.67 1.5 1.5v16c0 .83-.67 1.5-1.5 1.5h-9zM12 18c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/><path fill="currentColor" d="M16.48 2.52c3.27 1.55 5.61 4.72 5.97 8.48h1.5C23.44 4.84 18.29 0 12 0l-.66.03 3.81 3.81 1.33-1.32z"/></svg>
    <p>Please rotate your device to landscape mode</p>
  </div>

  <!-- Setup Screen -->
  <div id="setup-screen" class="setup-screen">
    <div class="setup-card">
      <h1>Game Setup</h1>
      
      <div class="setup-section">
        <label>Format</label>
        <div class="format-select" id="format-select">
          <button data-value="commander" class="selected">Commander</button>
        </div>
      </div>

      <div class="setup-section">
        <label>Players</label>
        <div class="player-select" id="player-count">
          <button data-value="2">
            <svg viewBox="0 0 100 100"><circle cx="50" cy="20" r="12"/><circle cx="50" cy="80" r="12"/></svg>
            <span>2</span>
          </button>
          <button data-value="3">
            <svg viewBox="0 0 100 100"><circle cx="50" cy="15" r="10"/><circle cx="20" cy="75" r="10"/><circle cx="80" cy="75" r="10"/></svg>
            <span>3</span>
          </button>
          <button data-value="4" class="selected">
            <svg viewBox="0 0 100 100"><circle cx="20" cy="20" r="10"/><circle cx="80" cy="20" r="10"/><circle cx="20" cy="80" r="10"/><circle cx="80" cy="80" r="10"/></svg>
            <span>4</span>
          </button>
        </div>
      </div>

      <div class="setup-section">
        <label>Starting Life</label>
        <div class="life-select" id="starting-life">
          <button data-value="20">20</button>
          <button data-value="40" class="selected">40</button>
          <button data-value="30">30</button>
        </div>
      </div>

      <button id="start-game" class="start-btn">Start Game</button>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="game-screen" class="game-screen hidden">
    <div id="players-container" class="players-container"></div>
    
    <div class="tools-bar">
      <div id="basic-tools" class="tools-group">
        <div class="clocks">
          <div class="clock-item">
            <span class="clock-label">Game</span>
            <span id="game-clock" class="clock-time">0:00</span>
          </div>
          <div class="clock-item">
            <span class="clock-label">Turn</span>
            <span id="turn-clock" class="clock-time">0:00</span>
          </div>
        </div>
        <div id="turn-counter" class="turn-counter">Turn 0</div>
        <button id="btn-first" class="tool-btn" title="Who Goes First">
          <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/></svg>
        </button>
        <button id="btn-pass" class="tool-btn" title="Pass Turn">
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z" fill="currentColor"/></svg>
        </button>
        <button id="btn-log" class="tool-btn" title="Game Log">
          <svg viewBox="0 0 24 24"><path d="M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z" fill="currentColor"/></svg>
        </button>
        <button id="btn-dice" class="tool-btn" title="Roll Dice">
          <svg class="dice-icon" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="3" fill="none" stroke="currentColor" stroke-width="2"/><circle cx="8" cy="8" r="1.5" fill="currentColor"/><circle cx="12" cy="12" r="1.5" fill="currentColor"/><circle cx="16" cy="16" r="1.5" fill="currentColor"/></svg>
        </button>
        <button id="btn-coin" class="tool-btn" title="Flip Coin">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/><text x="12" y="16" text-anchor="middle" font-size="10" fill="currentColor">$</text></svg>
        </button>
        <button id="btn-stack" class="tool-btn" title="Stack Tracker">
          <svg viewBox="0 0 24 24"><path d="M2 15.5v2h20v-2H2zm0-5v2h20v-2H2zm0-5v2h20v-2H2z" fill="currentColor"/><path d="M4 20h16v2H4z" fill="currentColor"/></svg>
        </button>
        <button id="btn-particles" class="tool-btn" title="Toggle Particles">
          <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" fill="currentColor"/><circle cx="7" cy="12" r="1.5" fill="currentColor"/><circle cx="12" cy="8" r="1.5" fill="currentColor"/><circle cx="17" cy="12" r="1.5" fill="currentColor"/><circle cx="12" cy="16" r="1.5" fill="currentColor"/></svg>
        </button>
        <button id="btn-phases" class="tool-btn" title="Turn Phases">
          <svg viewBox="0 0 24 24"><circle cx="4" cy="12" r="2" fill="currentColor"/><circle cx="12" cy="12" r="2" fill="currentColor"/><circle cx="20" cy="12" r="2" fill="currentColor"/><line x1="6" y1="12" x2="10" y2="12" stroke="currentColor" stroke-width="2"/><line x1="14" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2"/></svg>
        </button>
        <button id="btn-end" class="tool-btn" title="End Game">
          <svg viewBox="0 0 24 24"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="currentColor"/></svg>
        </button>
        <button id="btn-undo" class="tool-btn" title="Undo (Ctrl+Z)">
          <svg viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" fill="currentColor"/></svg>
        </button>
        <button id="btn-save" class="tool-btn" title="Share Game">
          <svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z" fill="currentColor"/></svg>
        </button>
        <button id="btn-note" class="tool-btn" title="Add Note (N)">
          <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="currentColor"/></svg>
        </button>
        <button id="btn-theme" class="tool-btn" title="Toggle Theme">
          <svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" fill="currentColor"/></svg>
        </button>
        <button id="btn-animations" class="tool-btn" title="Toggle Animations">
          <svg viewBox="0 0 24 24"><path d="M7.58 4.08L6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2c.15-2.65 1.51-4.97 3.55-6.42zm12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43c2.02 1.45 3.39 3.77 3.54 6.42zM18 11c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2v-5zm-6 11c.14 0 .27-.01.4-.04.65-.14 1.18-.58 1.44-1.18.1-.24.15-.5.15-.78h-4c.01 1.1.9 2 2.01 2z" fill="currentColor"/></svg>
        </button>
      </div>
      
      <div id="advanced-tools" class="tools-group hidden">
        <button id="btn-planeswalker" class="tool-btn" title="Planeswalker Tracker">
          <svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/></svg>
        </button>
        <button id="btn-monarch" class="tool-btn" title="Monarch/Initiative">
          <svg viewBox="0 0 24 24"><path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11h-2l-1-5-4 5-4-5-1 5H5zm14 3c0 .6-.4 1-1 1H6c-.6 0-1-.4-1-1v-1h14v1z" fill="currentColor"/></svg>
        </button>
        <button id="btn-daynight" class="tool-btn" title="Day/Night">
          <svg viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1z" fill="currentColor"/></svg>
        </button>
        <button id="btn-dungeon" class="tool-btn" title="Dungeon">
          <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H7v-5h5v5zm7 0h-5v-5h5v5zm0-7H5V5h14v5z" fill="currentColor"/></svg>
        </button>
        <button id="btn-ring" class="tool-btn" title="The Ring">
          <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-12.5c-2.49 0-4.5 2.01-4.5 4.5s2.01 4.5 4.5 4.5 4.5-2.01 4.5-4.5-2.01-4.5-4.5-4.5zm0 7c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="currentColor"/></svg>
        </button>
        <button id="btn-vote" class="tool-btn" title="Voting">
          <svg viewBox="0 0 24 24"><path d="M18 13h-.68l-2 2h1.91L19 17H5l1.78-2h2.05l-2-2H6l-3 3v4c0 1.1.89 2 1.99 2H19c1.1 0 2-.89 2-2v-4l-3-3zm-1-5.05l-4.95 4.95-3.54-3.54 4.95-4.95L17 7.95zm-4.24-5.66L6.39 8.66c-.39.39-.39 1.02 0 1.41l4.95 4.95c.39.39 1.02.39 1.41 0l6.36-6.36c.39-.39.39-1.02 0-1.41L14.16 2.3c-.38-.4-1.01-.4-1.4-.01z" fill="currentColor"/></svg>
        </button>
        <button id="btn-planechase" class="tool-btn" title="Planechase">
          <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/></svg>
        </button>
        <button id="btn-citys" class="tool-btn" title="City's Blessing">
          <svg viewBox="0 0 24 24"><path d="M15 11V5l-3-3-3 3v2H3v14h8v-4h2v4h8V11h-6zm-8 8H5v-2h2v2zm0-4H5v-2h2v2zm0-4H5V9h2v2zm6 4h-2v-2h2v2zm0-4h-2V9h2v2zm0-4h-2V5h2v2zm6 12h-2v-2h2v2zm0-4h-2v-2h2v2z" fill="currentColor"/></svg>
        </button>
      </div>
      
      <button id="btn-toggle-tools" class="tool-btn toggle-btn" title="Toggle Advanced Tools">
        <svg viewBox="0 0 24 24"><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill="currentColor"/></svg>
      </button>
      <button id="btn-reset" class="tool-btn" title="Reset">
        <svg viewBox="0 0 24 24"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" fill="currentColor"/></svg>
      </button>
      <button id="btn-menu" class="tool-btn" title="Home">
        <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" fill="currentColor"/></svg>
      </button>
    </div>
  </div>

  <!-- Dashboard Screen -->
  <div id="dashboard-screen" class="dashboard-screen hidden">
    <div class="dashboard-content">
      <h1>Game Summary</h1>
      <div class="dashboard-overview">
        <div class="dashboard-stat-box">
          <div class="stat-label">Total Time</div>
          <div class="stat-value" id="dashboard-game-time">0:00</div>
        </div>
        <div class="dashboard-stat-box">
          <div class="stat-label">Total Turns</div>
          <div class="stat-value" id="dashboard-turns">0</div>
        </div>
        <div class="dashboard-stat-box">
          <div class="stat-label">Avg Turn Time</div>
          <div class="stat-value" id="dashboard-avg-turn">0:00</div>
        </div>
        <div class="dashboard-stat-box">
          <div class="stat-label">Longest Turn</div>
          <div class="stat-value" id="dashboard-longest-turn">N/A</div>
        </div>
      </div>
      
      <div class="dashboard-charts">
        <div class="dashboard-chart-box">
          <h3>Life History</h3>
          <canvas id="life-chart"></canvas>
        </div>
        <div class="dashboard-chart-box">
          <h3>Damage Heatmap</h3>
          <div id="damage-heatmap"></div>
        </div>
      </div>
      
      <div class="dashboard-highlights">
        <div class="highlight-box" id="first-blood"></div>
        <div class="highlight-box" id="kingmaker"></div>
      </div>
      
      <h2>Player Rankings</h2>
      <div id="dashboard-players" class="dashboard-players"></div>
      
      <h3>Turn Time Leaderboard</h3>
      <div id="turn-time-leaderboard"></div>
      
      <div class="dashboard-actions">
        <button id="share-summary" class="action-btn secondary">Share Summary</button>
        <button id="dashboard-new-game" class="start-btn">New Game</button>
      </div>
    </div>
  </div>

  <!-- Commander Search Modal -->
  <div id="search-modal" class="modal hidden">
    <div class="modal-content search-content">
      <div class="modal-header">
        <h2>Set Commander</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="commander-slots" class="commander-slots">
        <div class="commander-slot active" data-slot="0">
          <span class="slot-label">Commander 1</span>
          <span class="slot-name" id="slot-name-0">Not set</span>
        </div>
        <div class="commander-slot hidden" data-slot="1">
          <span class="slot-label">Partner</span>
          <span class="slot-name" id="slot-name-1">Not set</span>
        </div>
      </div>
      <div class="search-box">
        <input type="text" id="search-input" placeholder="Search commanders..." autocomplete="off">
      </div>
      <div id="search-results" class="search-results"></div>
      <div class="modal-actions">
        <label class="rotate-toggle"><input type="checkbox" id="rotate-player"> Rotate panel 180¬∞</label>
        <button id="clear-commander" class="action-btn secondary">Clear Commander(s)</button>
      </div>
    </div>
  </div>

  <!-- Dice Modal -->
  <div id="dice-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Roll Dice</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="dice-type-select">
        <button class="dice-type-btn selected" data-sides="6">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <rect x="5" y="5" width="40" height="40" rx="4" fill="none" stroke="currentColor" stroke-width="2"/>
            <circle cx="16" cy="16" r="3" fill="currentColor"/><circle cx="34" cy="16" r="3" fill="currentColor"/>
            <circle cx="16" cy="34" r="3" fill="currentColor"/><circle cx="34" cy="34" r="3" fill="currentColor"/>
            <circle cx="25" cy="25" r="3" fill="currentColor"/>
          </svg>
          <span>D6</span>
        </button>
        <button class="dice-type-btn" data-sides="12">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <polygon points="25,2 47,15 47,35 25,48 3,35 3,15" fill="none" stroke="currentColor" stroke-width="2"/>
            <line x1="25" y1="2" x2="25" y2="48" stroke="currentColor" stroke-width="1.5"/>
            <line x1="3" y1="15" x2="47" y2="35" stroke="currentColor" stroke-width="1.5"/>
            <line x1="47" y1="15" x2="3" y2="35" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>D12</span>
        </button>
        <button class="dice-type-btn" data-sides="20">
          <svg class="dice-icon-svg" viewBox="0 0 50 50">
            <polygon points="25,2 45,18 38,45 12,45 5,18" fill="none" stroke="currentColor" stroke-width="2"/>
            <line x1="25" y1="2" x2="12" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="25" y1="2" x2="38" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="5" y1="18" x2="38" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <line x1="45" y1="18" x2="12" y2="45" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="25" cy="28" r="8" fill="none" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>D20</span>
        </button>
      </div>
      <div class="dice-count-select">
        <button id="dice-minus" class="count-btn">‚àí</button>
        <span id="dice-num">1</span>
        <button id="dice-plus" class="count-btn">+</button>
      </div>
      <div id="dice-stage" class="dice-stage"></div>
      <button id="roll-dice" class="action-btn">Roll</button>
    </div>
  </div>

  <!-- Coin Modal -->
  <div id="coin-modal" class="modal hidden">
    <div class="modal-content coin-content">
      <div class="modal-header">
        <h2>Flip Coin</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="coin-stage">
        <div id="coin" class="coin-3d">
          <div class="coin-face heads"></div>
          <div class="coin-face tails"></div>
        </div>
      </div>
      <div id="coin-result" class="coin-result"></div>
      <button id="flip-coin" class="action-btn">Flip</button>
    </div>
  </div>

  <!-- Commander Damage Modal -->
  <div id="cmdr-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Commander Damage</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="cmdr-grid" class="cmdr-grid"></div>
    </div>
  </div>

  <!-- Counters Modal -->
  <div id="counters-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="counters-title">Counters</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="counters-grid" class="counters-grid"></div>
    </div>
  </div>

  <!-- Mana Modal (mobile) -->
  <div id="mana-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="mana-title">Mana</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="mana-grid" class="mana-grid"></div>
    </div>
  </div>

  <!-- Game Log Modal -->
  <div id="log-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Game Log</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div id="log-list" class="log-list"></div>
    </div>
  </div>

  <!-- Stack Tracker Modal -->
  <div id="stack-modal" class="modal hidden">
    <div class="modal-content stack-content">
      <div class="modal-header">
        <h2>Stack Tracker</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="stack-search-box">
        <input type="text" id="stack-search-input" placeholder="Search for a card..." autocomplete="off">
      </div>
      <div id="stack-search-results" class="stack-search-results"></div>
      <div id="stack-player-selector" class="stack-player-selector hidden"></div>
      <div class="stack-label">Stack</div>
      <div id="stack-container" class="stack-container"></div>
    </div>
  </div>

  <!-- Turn Phases Modal -->
  <div id="phases-modal" class="modal hidden">
    <div class="modal-content phases-content">
      <div class="modal-header">
        <h2>Turn Phases</h2>
        <button class="close-btn">&times;</button>
      </div>
      <div class="phases-display">
        <div id="phase-display" class="phase-display">
          <div class="phase-main">
            <div id="current-phase-number" class="phase-subtitle">Phase 1 of 5</div>
            <div id="current-phase-name" class="phase-title">Beginning Phase</div>
          </div>
          <div id="step-display" class="step-display">
            <div id="current-step-number" class="step-subtitle">Step 1 of 3</div>
            <div id="current-step-name" class="step-title">Untap Step</div>
          </div>
        </div>
        <div id="phase-dots" class="phase-dots"></div>
        <div id="step-dots" class="step-dots"></div>
      </div>
      <button id="next-phase" class="action-btn">Next ‚Üí</button>
    </div>
  </div>

  <!-- Advanced Tool Modals -->
  <div id="planeswalker-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h2>Planeswalker Tracker</h2><button class="close-btn">&times;</button></div>
      <h3 style="margin: 15px 20px 10px; font-size: 0.9rem;">Select Player</h3>
      <div id="pw-player-select" class="token-players"></div>
      <div class="search-box">
        <input type="text" id="pw-search-input" placeholder="Search planeswalkers..." autocomplete="off">
      </div>
      <div id="pw-search-results" class="search-results"></div>
      <div id="pw-list" class="pw-list"></div>
    </div>
  </div>

  <div id="monarch-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h2>Monarch & Initiative</h2><button class="close-btn">&times;</button></div>
      <h3 style="margin: 15px 20px 10px; font-size: 0.9rem;">üëë Monarch</h3>
      <div id="monarch-players" class="token-players"></div>
      <h3 style="margin: 15px 20px 10px; font-size: 0.9rem;">‚öîÔ∏è Initiative</h3>
      <div id="initiative-players" class="token-players"></div>
    </div>
  </div>

  <div id="daynight-status" class="daynight-indicator">‚òÄÔ∏è Day</div>

  <div id="dungeon-modal" class="modal hidden">
    <div class="modal-content" style="max-width: 600px;">
      <div class="modal-header"><h2>Dungeon</h2><button class="close-btn">&times;</button></div>
      <h3 style="margin: 15px 20px 10px; font-size: 0.9rem;">Select Player</h3>
      <div id="dungeon-player-select" class="token-players"></div>
      <div id="dungeon-display" style="padding: 20px; text-align: center;"></div>
    </div>
  </div>

  <div id="ring-modal" class="modal hidden">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header"><h2>The Ring Tempts You</h2><button class="close-btn">&times;</button></div>
      <div style="padding: 20px; text-align: center;">
        <img src="https://cards.scryfall.io/large/front/d/4/d4eadebc-c30f-4d5f-a1f0-d6b3e876c186.jpg" style="width: 100%; max-width: 300px; border-radius: 12px; margin-bottom: 15px;" alt="The Ring">
        <div style="margin-bottom: 15px;">Ring Bearer: <span id="ring-bearer-name" style="color: var(--accent); font-weight: 600;">None</span></div>
        <div style="margin-bottom: 15px;">Temptation: <span id="ring-temptation" style="font-size: 2rem; color: var(--accent); font-weight: 700;">0</span></div>
        <button id="ring-tempt" class="action-btn" style="margin-bottom: 15px;">The Ring Tempts You</button>
        <h3 style="margin: 15px 0 10px; font-size: 0.9rem;">Select Ring-bearer</h3>
        <div id="ring-players" class="token-players"></div>
      </div>
    </div>
  </div>

  <div id="vote-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h2>Voting</h2><button class="close-btn">&times;</button></div>
      <div id="vote-options" style="padding: 20px;"></div>
      <button id="tally-votes" class="action-btn">Tally Votes</button>
    </div>
  </div>

  <div id="planechase-modal" class="modal hidden">
    <div class="modal-content" style="max-width: 700px;">
      <div class="modal-header"><h2>Planechase</h2><button class="close-btn">&times;</button></div>
      <div style="padding: 20px; text-align: center;">
        <div id="plane-name" style="font-size: 1.1rem; margin-bottom: 15px; font-weight: 600;">Loading...</div>
        <div style="width: 100%; max-height: 400px; overflow: hidden; display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
          <img id="plane-img" style="max-width: 100%; max-height: 400px; border-radius: 12px; object-fit: contain;">
        </div>
        <div style="display: flex; gap: 10px; justify-content: center;">
          <button id="roll-plane" class="action-btn">üåÄ Planeswalk</button>
          <button id="roll-chaos" class="action-btn secondary">‚ö° Roll Chaos</button>
        </div>
      </div>
    </div>
  </div>

  <div id="citys-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h2>City's Blessing</h2><button class="close-btn">&times;</button></div>
      <div id="citys-players" class="token-players"></div>
    </div>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="js/game-tracker.js"></script>
</body>
</html>
